<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.gostudy.gos.mapper.ChatRoomMapper">
 	<!-- 1. 채팅방 생성 -->
 	<insert id="insertChatRoom"
 			parameterType="com.gostudy.gos.vo.ChatRoomVO">
 			INSERT INTO
 				chat_room
				(
					<!-- room_id = auto increment -->
					mentor_id
					, mentee_ID
					, region
					, category
					, chat_room_name
				)
 			VALUES
 				(
 					#{mentorId}
 					, #{menteeId}
 					, #{region}
 					, #{category}
 					, #{chatRoomName}
 				)
 	</insert>
 	
 	<!-- 2. 채팅방 조회 (멘토/멘티 기준) -->
 	<select id="selectChatRoom"
 			parameterType="map" 
 			resultType="com.gostudy.gos.vo.ChatRoomVO"> <!-- 2개이상의 파라미터이므로 mybatis가 
 															 자동으로 map으로 처리해줌 -->
 		SELECT	
 			room_id As roomId
 			, mentor_id AS mentorId 
 			, mentee_id AS menteeId
 			, created_at AS createdAt
 			, region
 			, category
 			, chat_room_name AS chatRoomName
 		FROM	
 			chat_room
 		WHERE
 			mentor_id = #{mentorId}
 			AND mentee_id = #{menteeId}
 	</select>
 	
 	<!-- 3. 채팅방 목록 조회 (멘토/멘티 기준) -->
 	<select id="selectChatRoomsByMember"
 			parameterType="int"
 			resultType="com.gostudy.gos.vo.ChatRoomVO">
 		SELECT	
 			room_id As roomId
 			, mentor_id AS mentorId 
 			, mentee_id AS menteeId
 			, created_at AS createdAt
 			, region
 			, category
 			, chat_room_name AS chatRoomName
 		FROM	
 			chat_room
 		WHERE
			mentor_id = #{memberId} 
			OR mentee_id = #{memberId}
 	</select>
 	
 </mapper>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.gostudy.gos.mapper.ChatMessageMapper">
	<!-- ChatMessageMapper 참조해서 생성 -->
	<!-- 1. 메시지 전송 -->
	<insert id="insertMessage"
			parameterType="com.gostudy.gos.vo.ChatMessageVO">
		INSERT 
			INTO
				chat_message(
					<!-- message_id = auto increment 생략 -->
					room_id
					, sender_id
					, message
				)
			VALUES
				(
					#{roomId}
					,#{senderId}
					,#{message}
				)			
	</insert>
	 	
 	<!-- 2. 채팅방 메시지 조회 -->
 	<select id="selectMessagesByRoom" 
 			parameterType="int"
 			resultType="com.gostudy.gos.vo.ChatMessageVO">
 		SELECT
 			message_id AS messageId
 			, room_id AS roomId
 			, sender_id AS senderId
 			, message		
 			, sent_at AS sentAt
 		FROM
 			chat_message
 		WHERE
 			room_id = #{roomId}
	</select>
	
	<!-- 3. 메시지 삭제 -->
	<delete id="deleteMessage"
			parameterType="int">
		DELETE
			FROM
				chat_message
		WHERE
			message_id = #{messageId}		
	</delete>
 </mapper>